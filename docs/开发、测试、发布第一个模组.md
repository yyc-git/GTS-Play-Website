---
sidebar_position: 1
---

# 开发、测试、发布第一个模组


本文介绍如何开发、测试、发布一个职业模组(career-test1)，其他模组的开发、测试、发布同理。

本职业模组包括了下面的职业特性:
- 生命上限增加50%
- 每持有50金币，伤害增加1%
- 减少100%伤害。受到攻击后，增加50%伤害，持续20秒


<!-- 职业模组的详细资料可参考[职业模组](职业模组.md) -->


<!-- ## 1. 模组开发环境准备

在开始开发模组之前，请确保您已经完成了[开发环境准备](简介#开发环境准备) -->

## 职业模组开发步骤

### 创建模组项目

1. 在 `mods/` 文件夹中创建新的文件夹，命名为career-test1
2. 复制现有模组的基本配置文件（`package.json`、`tsconfig.json`、`webpack.config.js` 等）
3. 修改配置文件以适应您的新模组

career-test1/目录结构应该如下：
```plaintext
├── src/    # 模组源代码文件夹
│   ├── asset/    # 模组资产文件夹
        │── career_test1_icon.png    # 职业图标（显示在游戏的“选择职业”页面）
│   └── other/    # 其他文件夹
        │── icon.jpg    # 模组图标（显示在游戏的“模组”相关页面）
│   └── Main.ts    # 模组主入口文件
├── package.json    # 模组配置文件
├── README.md    # 模组的描述文档
```


### 配置 `package.json`

`package.json` 是模组的核心配置文件，包含了模组的基本信息和依赖关系：

```json
{
    "name": "career-test1",
    "version": "0.0.1",
    "main": "./dist/static/js/main.js",
    "mod": {
        "protocolName": "career-protocol",
        "author": "Official",
        "displayName_cn": "职业（测试1）",
        "displayName_en": "Career(Test 1)",
        "repoLink": "https://github.com/yyc-git/GiantessPlay-Mod/tree/main/mods/career-test1",
        "icon": "./dist/other/icon.jpg",
        "isPublic": true,
        "dependentMods": [
            "career-feature-increasefullhp",
            "career-feature-increasedamagebycoin",
            "career-feature-reducedamagebutincreasewhendamaged"
        ]
    },
    // 其他配置...
}
```

关键配置项说明：
- `name`: 模组的唯一标识符
- `version`: 模组的版本号（遵循语义化版本规范），每次发布时需要更新
- `main`: 模组的入口文件（通常是 `./dist/static/js/main.js`），它是通过在该模组项目的根目录上执行`npm run webpack`而生成的
- `mod.protocolName`: 模组使用的协议名称（职业模组使用 `career-protocol`）
- `mod.displayName_cn/en`: 模组在游戏中的显示名称，分别为中文和英文
- `mod.repoLink`: 对外公开模组项目的仓库链接
- `mod.icon`: 模组的图标文件路径（通常是 `./dist/other/icon.jpg`）
- `mod.isPublic`: 是否公开模组（开发测试阶段设为 `false`）
- `mod.dependentMods`: 模组依赖的其他模组列表。这些模组应该已经被发布了

### 实现模组核心功能

<!-- 职业模组的核心功能实现位于 `src/Main.ts` 文件中，主要包含以下部分： -->
职业模组的核心功能实现位于 `src/Main.ts` 文件中，需要实现getBlockService(实现模组服务)、createBlockState(创建模组数据)这两个函数。详细介绍请参考[职业模组](职业模组.md#5-实现代码详解)
<!-- 
核心功能说明：
- `languageKey`: 定义模组使用的语言键值
- `_getTextData`: 提供多语言支持的数据
- `getBlockService`: 实现职业模组的核心服务
  - `getCareerData`: 返回职业的基本信息（标题、图标、所需宝石等）
  - `getCareerFeatureData`: 返回职业特性及其参数配置
  - `getCharacterType`: 指定职业适用的角色类型（巨大娘、小人或两者） -->


### 准备开发环境

- 在模组项目根目录下(mods/career-test1/)执行 `npm install` 安装依赖
- 在模组项目根目录下执行 `npm run watch`可以监听文件变化并进行Typescript编译检查


## 测试模组

### 本地测试

1. 确保 `package.json` 中的 `isPublic` 设为 `false`
2. 在模组项目根目录下依次执行 `npm run webpack`、`npm run publish_mod`，打包并发布模组
3. 点击[进入](https://gts-play.cn?mod)来进入游戏（调试模式）
4. 在模组->模组商店中，订阅发布的模组
5. 在选择职业页面，选择新的职业：职业（测试1），然后进入游戏场景即可测试该职业的效果

### 调试技巧

- 在模组的函数中使用 `console.log` 来打印数据，方便调试
- 在调试模式下，可以在游戏场景中按 `0` 键弹出调试面板，调用“生成军队”等调试命令

## 发布模组

### 准备发布

1. 确保模组功能完整且测试通过
2. 编写详细的模组说明文档:README.md

### 执行发布

1. 将 `package.json` 中的 `isPublic` 设为 `true`
2. 更新模组版本号（遵循语义化版本规范）
3. 在模组项目根目录下依次执行 `npm run webpack`、`npm run publish_mod`，打包并发布模组
4. 其他玩家可以在游戏的模组->模组商店中找到并订阅您的模组

<!-- ## 注意事项

- 所有模组都使用 TypeScript 开发，确保代码符合 TypeScript 的语法规范
- 模组的大小应该尽量小，避免影响游戏性能
- 遵循游戏的设计风格和平衡原则，不要创建过于强大的模组
- 定期更新模组，确保与游戏的最新版本兼容
- 为模组添加适当的错误处理和边界检查
- 提供清晰的模组说明和使用指南 -->

<!-- ## 7. 常见问题

### 7.1 模组加载失败

- 检查模组的依赖关系是否正确
- 确保模组版本与游戏版本兼容
- 查看浏览器控制台的错误信息

### 7.2 特性效果不生效

- 检查特性的 `applyFunc` 实现是否正确
- 确保特性适用于当前角色类型
- 检查特性数值是否在合理范围内

### 7.3 多语言支持问题

- 确保所有文本都提供了中英文版本
- 使用正确的语言键值和文本格式
- 测试不同语言环境下的显示效果 -->

---

通过以上步骤，您已经学会了如何开发、测试和发布一个职业模组。祝您开发顺利！